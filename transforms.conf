##########################################
#        windows_active_directory        #

[windows_active_directory1]
REGEX = (?<raw_month>\w{3})\s+\d{1,2}\s\d{0,2}:\d{0,2}:\d{0,2}\s+(?<dvc_ip>\d{0,3}.\d{0,3}.\d{0,3}.\d{0,3}) (?<dest_dns>[^\t]+)\t(?:[^\t]+\t|)[^\t]+\t\d+\tSecurity\t\d+\t\S+ \S+\s+(?<raw_date>\d{1,2}\s\d{0,2}:\d{0,2}:\d{0,2})(?:\s+\d+|)\t(?<raw_event_id>\d+).+

[windows_active_directory2]
REGEX = (?<raw_month>\w{3})\s+(?<raw_date>\d{1,2}\s\d{0,2}:\d{0,2}:\d{0,2})\s+(?<dvc_ip>\d{0,3}.\d{0,3}.\d{0,3}.\d{0,3})\s+\S+Security\S+\s\S+\s(?<raw_event_id>\d+).+

[ad_field_extract_0]
SOURCE_KEY = _raw
REGEX = (?:4720|4726|4738|4725)(.|\r|\n)+?(?:帐户名(?:称|)|帳戶名稱|使用者名稱|Account Name):\s+(?<src_user>.+?)\s+(?:Account Domain|帐户域|帳戶網域|網域|使用者網域|支援領域名稱):(?:\t+|\s+)(?<src_zone>.+?)\s+?(.|\r|\n)+?(?:新登录|New Logon|新(?:的|)|登录失败的帐户|Account For Which Logon Failed|登入失敗的帳戶|新帳戶|登入失敗|登入成功|登出|帳戶登入|New Account|目標帳戶|Target Account).+?(?:安全性識別碼|服務識別碼|Security ID|安全 ID):\s+\w+-\d+-\d+-\d+-\d+-\d+-\d+-(?<user_sid>\d+)\s+(?:帐户名(?:称|)|帳戶名稱|使用者名稱|Account Name):\s+(?<user>.+?)\s+

[ad_field_extract_1]
SOURCE_KEY = _raw
REGEX = (?:新登录|New Logon|新(?:的|)|登录失败的帐户|Account For Which Logon Failed|登入失敗的帳戶|新帳戶|登入失敗|登入成功|登出|帳戶登入)(.|\r|\n)+?(?:帐户名(?:称|)|帳戶名稱|使用者名稱|Account Name):\s+(?<src_user>.+?)\s+(?:Account Domain|帐户域|帳戶網域|網域|使用者網域|支援領域名稱):(?:\t+|\s+)(?<src_zone>.+?)\s+

[ad_field_extract_2]
SOURCE_KEY = _raw
REGEX = (?:Logon|新登录|登入|成員|帳戶|目標電腦|帳戶資訊|群組|鎖定的帳戶):\s+(?:Security ID|安全 ID|安全性識別碼|服務識別碼):\s+\w+-\d+-\d+-\d+-\d+-\d+-\d+-(?<user_sid>\d+)\s+(?:帳戶名稱|Account Name|帐户名称):\s+(?<src_user>[^\s]+|)\s+(?:Account Domain|帐户域|帳戶網域|其他資訊:.+?呼叫者電腦名稱):\s+(?<src_zone>.+?|)\s

[ad_field_extract_3]
SOURCE_KEY = _raw
REGEX = (?:4728|4729|4756|4732|4733|4757)(.|\r|\n)+?(?:帐户名(?:称|)|帳戶名稱|使用者名稱|Account Name):\s+(?<src_user>.+?)\s+(?:Account Domain|帐户域|帳戶網域|網域|使用者網域|支援領域名稱):(?:\t+|\s+)(?<src_zone>.+?)\s+(.|\r|\n)+?(?:安全性識別碼|服務識別碼|Security ID|安全 ID):\s+\w+-\d+-\d+-\d+-\d+-\d+-\d+-(?<user_sid>\d+)\s+(?:帳戶名稱|Account Name|帐户名称):\s+(?:cn=|CN=)(?<user>[^,]+)

[ad_field_extract_3_1]
SOURCE_KEY = _raw
REGEX = (?:4756)(.|\r|\n)+?(?:帐户名(?:称|)|帳戶名稱|使用者名稱|Account Name):\s+(?<src_user>.+?)\s+(?:Account Domain|帐户域|帳戶網域|網域|使用者網域|支援領域名稱):(?:\t+|\s+)(?<src_zone>.+?)\s+(.|\r|\n)+?(?:安全性識別碼|服務識別碼|Security ID|安全 ID):\s+\w+-\d+-\d+-\d+-\d+-\d+-\d+-(?<user_sid>\d+)\s+(?:帳戶名稱|Account Name|帐户名称):\s+(?:cn|CN)=(?<user>[^,]+).+?(帳戶名稱|Group Name|帐户名(?:称|)):\s+(?<group_name>.+|)\s+(?:帳戶網域|Group Domain|Account Domain|帐户域)

[ad_field_extract_3_2]
SOURCE_KEY = _raw
REGEX = (?:4728|4729|4756|4732|4733|4757)(.|\r|\n)+?(?:帐户名(?:称|)|帳戶名稱|使用者名稱|Account Name):\s+(?<src_user>.+?)\s+(?:Account Domain|帐户域|帳戶網域|網域|使用者網域|支援領域名稱):(?:\t+|\s+)(?<src_zone>.+?)\s+.+?(?:安全性識別碼|服務識別碼|Security ID|安全 ID):\s+\w+-\d+-\d+-\d+-\d+-\d+-\d+-(?<user_sid>\d+)\s+(?:帳戶名稱|Account Name|帐户名称):\s+(?<user>[^\s]+)\s+(?:群組|Group)

[ad_field_extract_4]
SOURCE_KEY = _raw
REGEX = (?:新登入|登入失敗的帳戶|新帳戶|帳戶資訊|New Account)(.|\r|\n)+?(?:帳戶名稱|Account Name):\s+(?<src_user>.+?)\s+(?:帳戶網域|Account Domain):(?:\t+|\s+)(?<src_zone>.+?)\s+

[ad_field_extract_5]
SOURCE_KEY = _raw
REGEX = (?:登入類型|Logon Type):\s+(?<logon_type>\d)

[ad_field_extract_6]
SOURCE_KEY = _raw
REGEX = 失敗資訊:\s+失敗原因:\s+(?<fail_reason>.+?)\s+狀態:
                                                              
[ad_field_extract_7]
SOURCE_KEY = _raw
REGEX = Failure Information:\s+Failure Reason:\s+(?<fail_reason>.+?)\s+Status:

[ad_field_extract_8]
SOURCE_KEY = _raw
REGEX = 狀態:\s+[^\s]+\s+子狀態:\s+(?<result_code>[^\s]+)\s+

[ad_field_extract_9]
SOURCE_KEY = _raw
REGEX = Status:\s+[^\s]+\s+Sub Status:\s+(?<result_code>[^\s]+)\s+

[ad_field_extract_10]
SOURCE_KEY = _raw
REGEX = 錯誤碼:\s+(?<result_code>\S+)

[ad_field_extract_11]
SOURCE_KEY = _raw
REGEX = Failure Code:\s+(?<result_code>\S+)

[ad_field_extract_12]
SOURCE_KEY = _raw
REGEX = Error Code:\s+(?<result_code>\S+)

[ad_field_extract_13]
SOURCE_KEY = _raw
REGEX = 目標伺服器名稱:\s+(?<dest_category>\S+|)\s+

[ad_field_extract_14]
SOURCE_KEY = _raw
REGEX = (?:處理程序名稱|Process Name|登入處理程序):\s+(?<logon_process>.+?)\s+(?:網路資訊:|權杖權限提高類型:|結束狀態:|Token Elevation Type:|服務要求資訊:)

[ad_field_extract_15]
SOURCE_KEY = _raw
REGEX = (?:網路位址|來源網路位址|Source Network Address|來源位址):\s+(?<src>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}|[^ ]+|)\s+(?:連接埠|來源連接埠|Source Port):\s+(?<src_port>\d+|)

[ad_field_extract_16]
SOURCE_KEY = _raw
REGEX = (?:Kerberos 預先驗證失敗。|Kerberos 预身份验证失败。|Kerberos pre-authentication failed.)(.|\r|\n)+?(?:帳戶名稱|帐户名称|Account Name):\s+(?<src_user>.+?)\s+(?:服務資訊|服务信息|Service Information):(.|\r|\n)+?(?:Client Address|用戶端位址|客户端地址):\s+(?:[\S:]+:|)(?<src>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})\s+(?:用戶端連接埠|客户端端口|Client Port):\s+(?<src_port>\d+)\s+(?:其他資訊|附加信息|Additional Information):

[ad_field_extract_17]
SOURCE_KEY = _raw
REGEX = Kerberos pre-authentication failed(.|\r|\n)+?Account Name:\s+(?<src_user>.+?)\s+Service Information:(.|\r|\n)+?Client Address:\s+(?:[\S:]+:|)(?<src>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})\s+Client Port:\s+(?<src_port>\d+)\s+Additional Information:

[ad_field_extract_18]
SOURCE_KEY = _raw
REGEX = 已要求 Kerberos 服務票證。(.|\r|\n)+?帳戶名稱:\s*(?<src_user>\S+|)\s+帳戶網域(.|\r|\n)+?網路資訊:(.|\r|\n)+?用戶端位址:\s+(?:[\S:]+:|)(?<src>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})\s+用戶端連接埠:\s*(?<src_port>\d+).+票證加密類型:\s+(?<ticket_code>[^\s]+)

[ad_field_extract_19]
SOURCE_KEY = _raw
REGEX = 已要求 Kerberos 驗證票證 (.|\r|\n)+?帳戶名稱:\s*(?<src_user>\S+|)\s+.+服務識別碼:\s+\w+-\d+-\d+-\d+-\d+-\d+-\d+-(?<user_sid>\d+)\s+.+用戶端位址:\s+(?:[\S:]+:|)(?<src>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})\s+用戶端連接埠:\s*(?<src_port>\d+).+票證加密類型:\s+(?<ticket_code>[^\s]+)

[ad_field_extract_20]
SOURCE_KEY = _raw
REGEX = (?:主旨|主體|Subject|使用者):\s+(?:安全性識別碼|Security ID|安全 ID):\s+\w+[\d-]+\s+(?:\S|)(?:帳戶名稱|Account Name|帐户名称):\s+(?<src_host>[^\s]+|)\s+(?:帳戶網域|Account Domain|帐户域):\s+(?<src_zone2>[^\s]+|)\s

[ad_field_extract_21]
SOURCE_KEY = _raw
REGEX = 已要求 Kerberos (?:驗證|服務)票證(?:\s\(TGT\)。|。|)(.|\r|\n)+?帳戶名稱:\s+(?<src_user>\S+|)(.|\r|\n)+?(?:帳戶網域:|支援領域名稱:)(?:\t+|\s+)(?<src_zone>.+?|)\s+(?:登入 GUID|使用者識別碼)(.|\r|\n)+?用戶端位址:\s+(?:[\S:]+:|)(?<src>\S+)(.|\r|\n)+?用戶端連接埠:\s*(?<src_port>\d+).+?>票證加密類型:\s+(?<ticket_code>[^\s]+)

[ad_field_extract_22]
SOURCE_KEY = _raw
REGEX = (?:工作站名稱|Workstation Name):\s+(?<computer_name>\S+|)\s+(?:網路位址|來源網路位址|Source Network Address)

[ad_field_extract_23]
SOURCE_KEY = _raw
REGEX = (?:驗證票證要求|預先驗證失敗):(.|\r|\n)+?使用者名稱:\s+(?<src_user>[^\s]+)\s+.+(?:支援領域名稱:\s+|服務名稱:\s+[^/]+?/)(?<src_zone>.+?)\s+(.|\r|\n)+?用戶端位址:\s+(?<src>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})

[ad_field_extract_24]
SOURCE_KEY = _raw
REGEX = (?:新增的|移除的)安全性啟用通用群組成員:\s+成員名稱:\s+(?:cn|CN)=(?<src_user>[^,]+)

[ad_field_extract_25]
SOURCE_KEY = _raw
REGEX = 呼叫者名稱:\s(?!\s|- )(?<src_host>.+?|)\s+呼叫者網域:\s(?!\s|- )(?<src_zone>.+?)(?:\s{5}\S|\s{4}$)

[ad_field_extract_26]
SOURCE_KEY = _raw
REGEX = (?:群組名稱|Group Name):\s+(?<group_name>.+|)\s+(?:群組網域|Group Domain)

[ad_field_extract_27]
SOURCE_KEY = _raw
REGEX = Service Name:\s+(?<Service_name>.+?)\s+Service File Name:\s+(?<Service_file>.+?)\s+Service Type

[ad_field_extract_28]
SOURCE_KEY = _raw
REGEX = (?:5136|5145|5142)(.|\r|\n)+?(?:帐户名(?:称|)|帳戶名稱|使用者名稱|Account Name):\s+(?<src_user>.+?)\s+(?:Account Domain|帐户域|帳戶網域|網域|使用者網域|支援領域名稱):(?:\t+|\s+)(?<src_zone>.+?)\s+?登入識別碼:.+(?:目錄服務|共用資訊):\s+(?<msg>.+?)\s+(?:語法
|ReadAttributes)


[soc_windows_ad_signature_mapping]
batch_index_query = 0
case_sensitive_match = 0
filename = soc_windows_ad_signature_mapping.csv

[soc_result_code_mapping]
batch_index_query = 0
case_sensitive_match = 0
filename = soc_result_code_mapping.csv

